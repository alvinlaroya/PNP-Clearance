!function(){var e={760:function(e){e.exports={XMLSerializer:window.XMLSerializer,DOMParser:window.DOMParser,XMLDocument:window.XMLDocument}},712:function(e){e.exports=function(e,t,r){for(var n={},o=0,a=e.length;o<a;o++){var i=e[o],s=i.getAttribute("ContentType"),l=i.getAttribute("PartName").substr(1);n[l]=s}for(var u=function(e,o){var a=t[e],i=a.getAttribute("ContentType"),s=a.getAttribute("Extension");r.file(/./).map((function(e){var t=e.name;t.slice(t.length-s.length)!==s||n[t]||"[Content_Types].xml"===t||(n[t]=i)}))},c=0,p=t.length;c<p;c++)u(c);return n}},557:function(e,t,r){function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var o=r(760),a=o.DOMParser,i=o.XMLSerializer,s=r(257).throwXmlTagNotFound,l=r(287),u=l.last,c=l.first,p={},f=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"]],h=f.map((function(e){var t,r,o=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=o[0],i=o[1];return{rstart:new RegExp(i,"g"),rend:new RegExp(a,"g"),start:i,end:a}})),d=new RegExp(String.fromCharCode(160),"g");function g(e,t){return e==="</"+t+">"}function v(e,t){return 0===e.indexOf("<"+t)&&-1!==[">"," ","/"].indexOf(e[t.length+1])}function m(e,t,r){"string"==typeof t&&(t=[t]);for(var n=1,o=r,a=e.length;o<a;o++)for(var i=e[o],s=0,l=t.length;s<l;s++){var u=t[s];if(g(i.value,u)&&n--,v(i.value,u)&&n++,0===n)return o}return null}function y(e,t,r){"string"==typeof t&&(t=[t]);for(var n=1,o=r;o>=0;o--)for(var a=e[o],i=0,s=t.length;i<s;i++){var l=t[i];if(v(a.value,l)&&n--,g(a.value,l)&&n++,0===n)return o}return null}function x(e,t){var r=t.type,n=t.tag,o=t.position;return"tag"===r&&n===e&&"start"===o}function w(e,t){var r=t.type,n=t.tag,o=t.position;return"tag"===r&&n===e&&"end"===o}var b=/[\x00-\x08\x0B\x0C\x0E-\x1F]/;e.exports={endsWith:function(e,t){return-1!==e.indexOf(t,e.length-t.length)},startsWith:function(e,t){return e.substring(0,t.length)===t},isContent:function(e){var t=e.type,r=e.position;return"placeholder"===t||"content"===t&&"insidetag"===r},isParagraphStart:function(e){return x("w:p",e)||x("a:p",e)},isParagraphEnd:function(e){return w("w:p",e)||w("a:p",e)},isTagStart:function(e,t){var r=t.type,n=t.tag,o=t.position;return"tag"===r&&n===e&&("start"===o||"selfclosing"===o)},isTagEnd:w,isTextStart:function(e){var t=e.type,r=e.position,n=e.text;return"tag"===t&&"start"===r&&n},isTextEnd:function(e){var t=e.type,r=e.position,n=e.text;return"tag"===t&&"end"===r&&n},isStarting:v,isEnding:g,isModule:function(e,t){var r=e.module,n=e.type;return t instanceof Array||(t=[t]),"placeholder"===n&&-1!==t.indexOf(r)},uniq:function(e){for(var t={},r=[],n=0,o=e.length;n<o;++n)t[e[n]]||(t[e[n]]=!0,r.push(e[n]));return r},chunkBy:function(e,t){return e.reduce((function(e,r){var n=u(e),o=t(r);return"start"===o?e.push([r]):"end"===o?(n.push(r),e.push([])):n.push(r),e}),[[]]).filter((function(e){return e.length>0}))},last:u,first:c,mergeObjects:function(){for(var e,t,r={},n=0;n<arguments.length;n+=1){e=arguments[n],t=Object.keys(e);for(var o=0;o<t.length;o+=1)r[t[o]]=e[t[o]]}return r},xml2str:function(e){return(new i).serializeToString(e).replace(/xmlns(:[a-z0-9]+)?="" ?/g,"")},str2xml:function(e){return 65279===e.charCodeAt(0)&&(e=e.substr(1)),(new a).parseFromString(e,"text/xml")},getRightOrNull:m,getRight:function(e,t,r){var n=m(e,t,r);if(null!==n)return n;s({position:"right",element:t,parsed:e,index:r})},getLeftOrNull:y,getLeft:function(e,t,r){var n=y(e,t,r);if(null!==n)return n;s({position:"left",element:t,parsed:e,index:r})},pregMatchAll:function(e,t){for(var r,n=[];null!=(r=e.exec(t));)n.push({array:r,offset:r.index});return n},convertSpaces:function(e){return e.replace(d," ")},charMapRegexes:h,hasCorruptCharacters:function(e){return b.test(e)},defaults:{errorLogging:"json",paragraphLoop:!1,nullGetter:function(e){return e.module?"":"undefined"},xmlFileNames:["[Content_Types].xml"],parser:function(e){return{get:function(t){return"."===e?t:t[e]}}},linebreaks:!1,fileTypeConfig:null,delimiters:{start:"{",end:"}"}},wordToUtf8:function(e){for(var t,r=h.length-1;r>=0;r--)t=h[r],e=e.replace(t.rstart,t.end);return e},utf8ToWord:function(e){var t;e=e.toString();for(var r=0,n=h.length;r<n;r++)t=h[r],e=e.replace(t.rend,t.start);return e},concatArrays:function(e){for(var t=[],r=0;r<e.length;r++)for(var n=e[r],o=0,a=n.length;o<a;o++)t.push(n[o]);return t},invertMap:function(e){return Object.keys(e).reduce((function(t,r){var n=e[r];return t[n]=t[n]||[],t[n].push(r),t}),{})},charMap:f,getSingleAttribute:function(e,t){var r=e.indexOf(" ".concat(t,'="'));if(-1===r)return null;var n=e.substr(r).search(/["']/)+r,o=e.substr(n+1).search(/["']/)+n;return e.substr(n+1,o-n)},setSingleAttribute:function(e,t,r){var n;if(p[t]?n=p[t]:(n=new RegExp("(<.* ".concat(t,'=")([^"]*)(".*)$')),p[t]=n),n.test(e))return e.replace(n,"$1".concat(r,"$3"));var o=e.lastIndexOf("/>");return-1===o&&(o=e.lastIndexOf(">")),e.substr(0,o)+" ".concat(t,'="').concat(r,'"')+e.substr(o)},isWhiteSpace:function(e){return/^[ \n\r\t]+$/.test(e)}}},380:function(e,t,r){var n=["modules"];function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=r(557);l.traits=r(505),l.moduleWrapper=r(223);var u=r(919),c=r(257),p=c.throwMultiError,f=c.throwResolveBeforeCompile,h=c.throwRenderInvalidTemplate,d=r(567),g=r(712),v=r(107),m=r(303),y=l.defaults,x=l.str2xml,w=l.xml2str,b=l.moduleWrapper,T=l.concatArrays,P=l.uniq,O=r(257),E=O.XTInternalError,j=O.throwFileTypeNotIdentified,k=O.throwFileTypeNotHandled,C=O.throwApiVersionError,S=[3,31,0],A=function(){function e(t){var r=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=o.modules,l=void 0===s?[]:s,u=a(o,n);if(i(this,e),!Array.isArray(l))throw new Error("The modules argument of docxtemplater's constructor must be an array");if(this.scopeManagers={},this.compiled={},this.modules=[v()],this.setOptions(u),l.forEach((function(e){r.attachModule(e)})),arguments.length>0){if(!t||!t.files||"function"!=typeof t.file)throw new Error("The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)");this.loadZip(t),this.modules=this.modules.filter((function(e){if(e.supportedFileTypes){if(!Array.isArray(e.supportedFileTypes))throw new Error("The supportedFileTypes field of the module must be an array");var t=-1!==e.supportedFileTypes.indexOf(r.fileType);return t||e.on("detached"),t}return!0})),this.compile(),this.v4Constructor=!0}}var t,r;return t=e,r=[{key:"verifyApiVersion",value:function(e){return 3!==(e=e.split(".").map((function(e){return parseInt(e,10)}))).length&&C("neededVersion is not a valid version",{neededVersion:e,explanation:"the neededVersion must be an array of length 3"}),e[0]!==S[0]&&C("The major api version do not match, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:S,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(S.join("."))}),e[1]>S[1]&&C("The minor api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:S,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(S.join("."))}),e[1]===S[1]&&e[2]>S[2]&&C("The patch api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:e,currentModuleApiVersion:S,explanation:"moduleAPIVersionMismatch : needed=".concat(e.join("."),", current=").concat(S.join("."))}),!0}},{key:"setModules",value:function(e){this.modules.forEach((function(t){t.set(e)}))}},{key:"sendEvent",value:function(e){this.modules.forEach((function(t){t.on(e)}))}},{key:"attachModule",value:function(e){if(this.v4Constructor)throw new E("attachModule() should not be called manually when using the v4 constructor");var t=o(e);if("function"===t)throw new E("Cannot attach a class/function as a module. Most probably you forgot to instantiate the module by using `new` on the module.");if(!e||"object"!==t)throw new E("Cannot attachModule with a falsy value");if(e.requiredAPIVersion&&this.verifyApiVersion(e.requiredAPIVersion),!0===e.attached){if("function"!=typeof e.clone)throw new Error('Cannot attach a module that was already attached : "'.concat(e.name,'". The most likely cause is that you are instantiating the module at the root level, and using it for multiple instances of Docxtemplater'));e=e.clone()}e.attached=!0;var r=b(e);return this.modules.push(r),r.on("attached"),this}},{key:"setOptions",value:function(e){var t=this;if(this.v4Constructor)throw new Error("setOptions() should not be called manually when using the v4 constructor");if(!e)throw new Error("setOptions should be called with an object as first parameter");return this.options={},Object.keys(y).forEach((function(r){var n=y[r];t.options[r]=null!=e[r]?e[r]:n,t[r]=t.options[r]})),this.delimiters.start=l.utf8ToWord(this.delimiters.start),this.delimiters.end=l.utf8ToWord(this.delimiters.end),this.zip&&this.updateFileTypeConfig(),this}},{key:"loadZip",value:function(e){if(this.v4Constructor)throw new Error("loadZip() should not be called manually when using the v4 constructor");if(e.loadAsync)throw new E("Docxtemplater doesn't handle JSZip version >=3, please use pizzip");return this.zip=e,this.updateFileTypeConfig(),this.modules=T([this.fileTypeConfig.baseModules.map((function(e){return e()})),this.modules]),this}},{key:"precompileFile",value:function(e){var t=this.createTemplateClass(e);t.preparse(),this.compiled[e]=t}},{key:"compileFile",value:function(e){this.compiled[e].parse()}},{key:"getScopeManager",value:function(e,t,r){return this.scopeManagers[e]||(this.scopeManagers[e]=u({tags:r||{},parser:this.parser,cachedParsers:t.cachedParsers})),this.scopeManagers[e]}},{key:"resolveData",value:function(e){var t=this,r=[];return Object.keys(this.compiled).length||f(),Promise.resolve(e).then((function(e){return t.setData(e),t.setModules({data:t.data,Lexer:m}),t.mapper=t.modules.reduce((function(e,t){return t.getRenderedMap(e)}),{}),Promise.all(Object.keys(t.mapper).map((function(e){var n=t.mapper[e],o=n.from,a=n.data;return Promise.resolve(a).then((function(n){var a=t.compiled[o];return a.filePath=e,a.scopeManager=t.getScopeManager(e,a,n),a.resolveTags(n).then((function(e){return a.scopeManager.finishedResolving=!0,e}),(function(e){Array.prototype.push.apply(r,e)}))}))}))).then((function(e){return 0!==r.length&&(t.options.errorLogging&&d(r,t.options.errorLogging),p(r)),T(e)}))}))}},{key:"compile",value:function(){var e=this;return Object.keys(this.compiled).length||(this.options=this.modules.reduce((function(t,r){return r.optionsTransformer(t,e)}),this.options),this.options.xmlFileNames=P(this.options.xmlFileNames),this.xmlDocuments=this.options.xmlFileNames.reduce((function(t,r){var n=e.zip.files[r].asText();return t[r]=x(n),t}),{}),this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments}),this.getTemplatedFiles(),this.templatedFiles.forEach((function(t){null!=e.zip.files[t]&&e.precompileFile(t)})),this.templatedFiles.forEach((function(t){null!=e.zip.files[t]&&e.compileFile(t)})),this.setModules({compiled:this.compiled}),I(this)),this}},{key:"updateFileTypeConfig",value:function(){var t,r=this;this.zip.files.mimetype&&(t="odt");var n=this.zip.files["[Content_Types].xml"];this.targets=[];var o=n?x(n.asText()):null,a=o?o.getElementsByTagName("Override"):null,i=o?o.getElementsByTagName("Default"):null;return o&&(this.filesContentTypes=g(a,i,this.zip),this.invertedContentTypes=l.invertMap(this.filesContentTypes),this.setModules({contentTypes:this.contentTypes,invertedContentTypes:this.invertedContentTypes})),this.modules.forEach((function(e){t=e.getFileType({zip:r.zip,contentTypes:n,contentTypeXml:o,overrides:a,defaults:i,doc:r})||t})),"odt"===t&&k(t),t||j(),this.fileType=t,this.fileTypeConfig=this.options.fileTypeConfig||this.fileTypeConfig||e.FileTypeConfig[this.fileType](),this}},{key:"renderAsync",value:function(e){var t=this;return this.resolveData(e).then((function(){return t.render()}))}},{key:"render",value:function(e){var t=this;return this.compile(),this.errors.length>0&&h(),e&&this.setData(e),this.setModules({data:this.data,Lexer:m}),this.mapper=this.mapper||this.modules.reduce((function(e,t){return t.getRenderedMap(e)}),{}),Object.keys(this.mapper).forEach((function(e){var r=t.mapper[e],n=r.from,o=r.data,a=t.compiled[n];a.scopeManager=t.getScopeManager(e,a,o),a.render(e),t.zip.file(e,a.content,{createFolders:!0})})),I(this),this.sendEvent("syncing-zip"),this.syncZip(),this}},{key:"syncZip",value:function(){var e=this;Object.keys(this.xmlDocuments).forEach((function(t){e.zip.remove(t);var r=w(e.xmlDocuments[t]);return e.zip.file(t,r,{createFolders:!0})}))}},{key:"setData",value:function(e){return this.data=e,this}},{key:"getZip",value:function(){return this.zip}},{key:"createTemplateClass",value:function(e){var t=this.zip.files[e].asText();return this.createTemplateClassFromContent(t,e)}},{key:"createTemplateClassFromContent",value:function(t,r){var n=this,o={filePath:r,contentType:this.filesContentTypes[r]};return Object.keys(y).concat(["filesContentTypes","fileTypeConfig","fileType","modules"]).forEach((function(e){o[e]=n[e]})),new e.XmlTemplater(t,o)}},{key:"getFullText",value:function(e){return this.createTemplateClass(e||this.fileTypeConfig.textPath(this)).getFullText()}},{key:"getTemplatedFiles",value:function(){var e=this;return this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip),this.targets.forEach((function(t){e.templatedFiles.push(t)})),this.templatedFiles=P(this.templatedFiles),this.templatedFiles}}],r&&s(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function I(e){var t=e.compiled;e.errors=T(Object.keys(t).map((function(e){return t[e].allErrors}))),0!==e.errors.length&&(e.options.errorLogging&&d(e.errors,e.options.errorLogging),p(e.errors))}A.DocUtils=l,A.Errors=r(257),A.XmlTemplater=r(827),A.FileTypeConfig=r(952),A.XmlMatcher=r(465),e.exports=A},567:function(e){function t(e,t){return t instanceof Error?Object.getOwnPropertyNames(t).concat("stack").reduce((function(e,r){return e[r]=t[r],"stack"===r&&(e[r]=t[r].toString()),e}),{}):t}e.exports=function(e,r){if(console.log(JSON.stringify({error:e},t,"json"===r?2:null)),e.properties&&e.properties.errors instanceof Array){var n=e.properties.errors.map((function(e){return e.properties.explanation})).join("\n");console.log("errorMessages",n)}}},257:function(e,t,r){function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r(287),i=a.last,s=a.first;function l(e){this.name="GenericError",this.message=e,this.stack=new Error(e).stack}function u(e){this.name="TemplateError",this.message=e,this.stack=new Error(e).stack}function c(e){this.name="RenderingError",this.message=e,this.stack=new Error(e).stack}function p(e){this.name="ScopeParserError",this.message=e,this.stack=new Error(e).stack}function f(e){this.name="InternalError",this.properties={explanation:"InternalError"},this.message=e,this.stack=new Error(e).stack}function h(e){this.name="APIVersionError",this.properties={explanation:"APIVersionError"},this.message=e,this.stack=new Error(e).stack}l.prototype=Error.prototype,u.prototype=new l,c.prototype=new l,p.prototype=new l,f.prototype=new l,h.prototype=new l,e.exports={XTError:l,XTTemplateError:u,XTInternalError:f,XTScopeParserError:p,XTAPIVersionError:h,RenderingError:c,XTRenderingError:c,getClosingTagNotMatchOpeningTag:function(e){var t=e.tags,r=new u("Closing tag does not match opening tag");return r.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'.concat(t[0].value,'" is closed by the tag "').concat(t[1].value,'"'),openingtag:s(t).value,offset:[s(t).offset,i(t).offset],closingtag:i(t).value},r},getLoopPositionProducesInvalidXMLError:function(e){var t=e.tag,r=e.offset,n=new u('The position of the loop tags "'.concat(t,'" would produce invalid XML'));return n.properties={xtag:t,id:"loop_position_invalid",explanation:'The tags "'.concat(t,'" are misplaced in the document, for example one of them is in a table and the other one outside the table'),offset:r},n},getScopeCompilationError:function(e){var t=e.tag,r=e.rootError,n=e.offset,o=new p("Scope parser compilation failed");return o.properties={id:"scopeparser_compilation_failed",offset:n,xtag:t,explanation:'The scope parser for the tag "'.concat(t,'" failed to compile'),rootError:r},o},getScopeParserExecutionError:function(e){var t=e.tag,r=e.scope,n=e.error,o=e.offset,a=new p("Scope parser execution failed");return a.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag ".concat(t," failed to execute"),scope:r,offset:o,xtag:t,rootError:n},a},getUnclosedTagException:function(e){var t=new u("Unclosed tag");return t.properties={xtag:s(e.xtag.split(" ")).substr(1),id:"unclosed_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" is unclosed')},t},getUnopenedTagException:function(e){var t=new u("Unopened tag");return t.properties={xtag:i(e.xtag.split(" ")),id:"unopened_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" is unopened')},t},getUnmatchedLoopException:function(e){var t=e.location,r=e.offset,n="start"===t?"unclosed":"unopened",o=new u("".concat("start"===t?"Unclosed":"Unopened"," loop")),a=e.value;return o.properties={id:"".concat(n,"_loop"),explanation:'The loop with tag "'.concat(a,'" is ').concat(n),xtag:a,offset:r},o},getDuplicateCloseTagException:function(e){var t=new u("Duplicate close tag, expected one close tag");return t.properties={xtag:s(e.xtag.split(" ")),id:"duplicate_close_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag ending with "'.concat(e.xtag.substr(0,10),'" has duplicate close tags')},t},getDuplicateOpenTagException:function(e){var t=new u("Duplicate open tag, expected one open tag");return t.properties={xtag:s(e.xtag.split(" ")),id:"duplicate_open_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" has duplicate open tags')},t},getCorruptCharactersException:function(e){var t=e.tag,r=e.value,n=e.offset,o=new c("There are some XML corrupt characters");return o.properties={id:"invalid_xml_characters",xtag:t,value:r,offset:n,explanation:"There are some corrupt characters for the field ".concat(t)},o},getInvalidRawXMLValueException:function(e){var t=e.tag,r=e.value,n=e.offset,o=new c("Non string values are not allowed for rawXML tags");return o.properties={id:"invalid_raw_xml_value",xtag:t,value:r,offset:n,explanation:"The value of the raw tag : '".concat(t,"' is not a string")},o},getUnbalancedLoopException:function(e,t){var r=new u("Unbalanced loop tag"),n=t[0].part.value,o=t[1].part.value,a=e[0].part.value,i=e[1].part.value;return r.properties={id:"unbalanced_loop_tags",explanation:"Unbalanced loop tags {#".concat(n,"}{/").concat(o,"}{#").concat(a,"}{/").concat(i,"}"),offset:[t[0].part.offset,e[1].part.offset],lastPair:{left:t[0].part.value,right:t[1].part.value},pair:{left:e[0].part.value,right:e[1].part.value}},r},throwApiVersionError:function(e,t){var r=new h(e);throw r.properties=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:"api_version_error"},t),r},throwFileTypeNotHandled:function(e){var t=new f('The filetype "'.concat(e,'" is not handled by docxtemplater'));throw t.properties={id:"filetype_not_handled",explanation:'The file you are trying to generate is of type "'.concat(e,'", but only docx and pptx formats are handled'),fileType:e},t},throwFileTypeNotIdentified:function(){var e=new f("The filetype for this file could not be identified, is this file corrupted ?");throw e.properties={id:"filetype_not_identified",explanation:"The filetype for this file could not be identified, is this file corrupted ?"},e},throwMalformedXml:function(e){var t=new f("Malformed xml");throw t.properties={part:e,id:"malformed_xml"},t},throwMultiError:function(e){var t=new u("Multi error");throw t.properties={errors:e,id:"multi_error",explanation:"The template has multiple errors"},t},throwExpandNotFound:function(e){var t=e.part,r=t.value,n=t.offset,o=e.id,a=void 0===o?"raw_tag_outerxml_invalid":o,i=e.message,s=void 0===i?"Raw tag not in paragraph":i,l=e.part,c=e.explanation,p=void 0===c?'The tag "'.concat(r,'" is not inside a paragraph'):c;"function"==typeof p&&(p=p(l));var f=new u(s);throw f.properties={id:a,explanation:p,rootError:e.rootError,xtag:r,offset:n,postparsed:e.postparsed,expandTo:e.expandTo,index:e.index},f},throwRawTagShouldBeOnlyTextInParagraph:function(e){var t=new u("Raw tag should be the only text in paragraph"),r=e.part.value;throw t.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The raw tag "'.concat(r,'" should be the only text in this paragraph. This means that this tag should not be surrounded by any text or spaces.'),xtag:r,offset:e.part.offset,paragraphParts:e.paragraphParts},t},throwUnimplementedTagType:function(e,t){var r='Unimplemented tag type "'.concat(e.type,'"');e.module&&(r+=' "'.concat(e.module,'"'));var n=new u(r);throw n.properties={part:e,index:t,id:"unimplemented_tag_type"},n},throwXmlTagNotFound:function(e){var t=new u('No tag "'.concat(e.element,'" was found at the ').concat(e.position)),r=e.parsed[e.index];throw t.properties={id:"no_xml_tag_found_at_".concat(e.position),explanation:'No tag "'.concat(e.element,'" was found at the ').concat(e.position),offset:r.offset,part:r,parsed:e.parsed,index:e.index,element:e.element},t},throwXmlInvalid:function(e,t){var r=new u("An XML file has invalid xml");throw r.properties={id:"file_has_invalid_xml",content:e,offset:t,explanation:"The docx contains invalid XML, it is most likely corrupt"},r},throwResolveBeforeCompile:function(){var e=new f("You must run `.compile()` before running `.resolveData()`");throw e.properties={id:"resolve_before_compile",explanation:"You must run `.compile()` before running `.resolveData()`"},e},throwRenderInvalidTemplate:function(){var e=new f("You should not call .render on a document that had compilation errors");throw e.properties={id:"render_on_invalid_template",explanation:"You should not call .render on a document that had compilation errors"},e}}},952:function(e,t,r){var n=r(19),o=r(95),a=r(182),i=r(999),s=r(163);e.exports={docx:function(){return{getTemplatedFiles:function(){return[]},textPath:function(e){return e.targets[0]},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","w:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["w:proofState","w:tc","w:tr","w:table","w:p","w:r","w:br","w:rPr","w:pPr","w:spacing","w:sdtContent","w:drawing","w:sectPr","w:type","w:headerReference","w:footerReference"],expandTags:[{contains:"w:tc",expand:"w:tr"}],onParagraphLoop:[{contains:"w:p",expand:"w:p",onlyTextInTag:!0}],tagRawXml:"w:p",baseModules:[n,o,i,a,s],tagShouldContain:[{tag:"w:tc",shouldContain:["w:p"],value:"<w:p></w:p>"},{tag:"w:sdtContent",shouldContain:["w:p","w:r"],value:"<w:p></w:p>"}]}},pptx:function(){return{getTemplatedFiles:function(){return[]},textPath:function(e){return e.targets[0]},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","a:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:table","a:p","a:r","a:rPr","p:txBody","a:txBody","a:off","a:ext","p:graphicFrame","p:xfrm","a16:rowId"],expandTags:[{contains:"a:tc",expand:"a:tr"}],onParagraphLoop:[{contains:"a:p",expand:"a:p",onlyTextInTag:!0}],tagRawXml:"p:sp",baseModules:[n,i,a,s],tagShouldContain:[{tag:"p:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"},{tag:"a:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"}]}}}},330:function(e){e.exports={docx:["application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","application/vnd.ms-word.document.macroEnabled.main+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml","application/vnd.ms-word.template.macroEnabledTemplate.main+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml"],pptx:["application/vnd.openxmlformats-officedocument.presentationml.slide+xml","application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml","application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml","application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml"]}},127:function(e,t,r){var n=r(557),o=n.startsWith,a=n.endsWith,i=n.isStarting,s=n.isEnding,l=n.isWhiteSpace,u=r(330);e.exports=function(e,t){var r=t.fileTypeConfig.tagShouldContain||[],n="",c=-1;-1!==u.docx.indexOf(t.contentType)&&(e=function(e){for(var t="",r=0,n=e.length;r<n;r++){var i=e[r];l(i)||(a(t,"</w:tbl>")&&(o(i,"<w:p")||o(i,"<w:tbl")||o(i,"<w:sectPr")||(i="<w:p/>".concat(i))),t=i,e[r]=i)}return e}(e));for(var p=0,f=e.length;p<f;p++)for(var h=e[p],d=0,g=r.length;d<g;d++){var v=r[d],m=v.tag,y=v.shouldContain,x=v.value;if(c===d){if(s(h,m)){c=-1,e[p]=n+x+h;break}n+=h;for(var w=0,b=y.length;w<b;w++){var T=y[w];if(i(h,T)){c=-1,e[p]=n;break}}c>-1&&(e[p]="");break}if(-1===c&&i(h,m)&&-1===h.substr(1).indexOf("<")){if("/"===h[h.length-2]){e[p]="";break}c=d,n=h,e[p]="";break}}return e}},303:function(e,t,r){function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var a=r(257),i=a.getUnclosedTagException,s=a.getUnopenedTagException,l=a.getDuplicateOpenTagException,u=a.getDuplicateCloseTagException,c=a.throwMalformedXml,p=a.throwXmlInvalid,f=a.XTTemplateError,h=r(557),d=h.isTextStart,g=h.isTextEnd,v=h.wordToUtf8;function m(e,t){return e[0]<=t.offset&&t.offset<e[1]}function y(e){var t="",r=1,n=e.indexOf(" ");return"/"===e[e.length-2]?(t="selfclosing",-1===n&&(n=e.length-2)):"/"===e[1]?(r=2,t="end",-1===n&&(n=e.length-1)):(t="start",-1===n&&(n=e.length-1)),{tag:e.slice(r,n),position:t}}function x(e,t){return-1===e&&-1===t?-2:e===t?0:-1===e||-1===t?t<e?-1:1:e<t?-1:1}function w(e){var t=e.split(" ");if(2!==t.length){var r=new f("New Delimiters cannot be parsed");throw r.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},r}var o=n(t,2),a=o[0],i=o[1];if(0===a.length||0===i.length){var s=new f("New Delimiters cannot be parsed");throw s.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},s}return[a,i]}function b(e,t){var r=e.map((function(e){return e.value})).join(""),o=function(e,t){for(var r=[],o=t.start,a=t.end,i=-1,s=!1;;){var l=e.indexOf(o,i+1),u=e.indexOf(a,i+1),c=null,p=void 0,f=x(l,u);if(-2===f)return r;if(0===f&&(f=s?1:-1),1===f&&(s=!1,i=u,c="end",p=a.length),-1===f&&(s=!0,i=l,c="start",p=o.length),"start"!==c||"="!==e[i+o.length])r.push({offset:i,position:c,length:p});else{r.push({offset:l,position:"start",length:o.length,changedelimiter:!0});var h=e.indexOf("=",i+o.length+1),d=e.indexOf(a,h+1);r.push({offset:d,position:"end",length:a.length,changedelimiter:!0});var g=n(w(e.substr(i+o.length+1,h-i-o.length-1)),2);o=g[0],a=g[1],i=d}}}(r,t),a=0,c=e.map((function(e){return{offset:(a+=e.value.length)-e.value.length,lIndex:e.lIndex}})),p=function(e,t){var r,n=[],o=!1,a={offset:0};e.forEach((function(e){r=t.substr(a.offset,e.offset-a.offset),"start"===e.position&&o||"end"===e.position&&!o?"start"===e.position?(a.offset+a.length===e.offset?(r=t.substr(a.offset,e.offset-a.offset+a.length+4),n.push(l({xtag:r,offset:a.offset}))):n.push(i({xtag:v(r),offset:a.offset})),e.error=!0):(a.offset+a.length===e.offset?(r=t.substr(a.offset-4,e.offset-a.offset+4+a.length),n.push(u({xtag:r,offset:a.offset}))):n.push(s({xtag:r,offset:e.offset})),e.error=!0):o=!o,a=e}));var c={offset:t.length};return r=t.substr(a.offset,c.offset-a.offset),o&&(n.push(i({xtag:v(r),offset:a.offset})),c.error=!0),n}(o,r),f=0,h=0,d=c.map((function(t,r){for(var n=t.offset,a=[n,n+e[r].value.length],i=e[r].value,s=[];h<o.length&&m(a,o[h]);)s.push(o[h]),h++;var l,u=[],c=0;f>0&&(c=f,f=0),s.forEach((function(e){var t=i.substr(c,e.offset-n-c);if(t.length>0){if(l)return void(e.changedelimiter&&(c=e.offset-n+e.length,l="start"===e.position));u.push({type:"content",value:t}),c+=t.length}var r={type:"delimiter",position:e.position,offset:c+n};if(e.changedelimiter)return l="start"===e.position,void(c=e.offset-n+e.length);u.push(r),c=e.offset-n+e.length})),f=c-i.length;var p=i.substr(c);return p.length>0&&u.push({type:"content",value:p}),u}),this);return{parsed:d,errors:p}}e.exports={parseDelimiters:b,parse:function(e,t){!function(e){var t=!1;e.forEach((function(e){t=function(e,t){return d(e)?(t&&c(e),!0):g(e)?(t||c(e),!1):t}(e,t),"content"===e.type&&(e.position=t?"insidetag":"outsidetag"),t&&"content"===e.type&&(e.value=e.value.replace(/>/g,"&gt;"))}))}(e);var r=b(function(e){return e.filter((function(e){return"content"===e.type&&"insidetag"===e.position}))}(e),t),n=r.parsed,o=r.errors,a=[],i=0,s=0;return e.forEach((function(e){"content"===e.type&&"insidetag"===e.position?(Array.prototype.push.apply(a,n[i].map((function(e){return"content"===e.type&&(e.position="insidetag"),e.lIndex=s++,e}))),i++):(e.lIndex=s++,a.push(e))})),{errors:o,lexed:a}},xmlparse:function(e,t){var r=function(e,t,r){for(var n=0,o=e.length,a={},i=0,s=t.length;i<s;i++)a[t[i]]=!0;for(var l=0,u=r.length;l<u;l++)a[r[l]]=!1;for(var c=[];n<o&&-1!==(n=e.indexOf("<",n));){var f=n,h=e.indexOf("<",n+1);(-1===(n=e.indexOf(">",n))||-1!==h&&n>h)&&p(e,f);var d=e.slice(f,n+1),g=y(d),v=g.tag,m=g.position,x=a[v];null!=x&&c.push({type:"tag",position:m,text:x,offset:f,value:d,tag:v})}return c}(e,t.text,t.other),n=0,o=r.reduce((function(t,r){var o=e.substr(n,r.offset-n);return o.length>0&&t.push({type:"content",value:o}),n=r.offset+r.value.length,delete r.offset,t.push(r),t}),[]),a=e.substr(n);return a.length>0&&o.push({type:"content",value:a}),o}}},509:function(e){function t(e,t){for(var r=-1,n=0,o=e.length;n<o;n++)t[n]>=e[n].length||(-1===r||e[n][t[n]].offset<e[r][t[r]].offset)&&(r=n);return r}e.exports=function(e){var r=e.reduce((function(e,t){return e+t.length}),0);e=e.filter((function(e){return e.length>0}));for(var n=new Array(r),o=e.map((function(){return 0})),a=0;a<=r-1;){var i=t(e,o);n[a]=e[i][o[i]],o[i]++,a++}return n}},223:function(e,t,r){var n=r(257).XTInternalError;function o(){}function a(e){return e}e.exports=function(e){var t={set:o,matchers:function(){return[]},parse:o,render:o,getTraits:o,getFileType:o,nullGetter:o,optionsTransformer:a,postrender:a,errorsTransformer:a,getRenderedMap:a,preparse:a,postparse:a,on:o,resolve:o};if(Object.keys(t).every((function(t){return!e[t]}))){var r=new n("This module cannot be wrapped, because it doesn't define any of the necessary functions");throw r.properties={id:"module_cannot_be_wrapped",explanation:"This module cannot be wrapped, because it doesn't define any of the necessary functions"},r}return Object.keys(t).forEach((function(r){e[r]=e[r]||t[r]})),e}},107:function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(223),a=r(330),i=["application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","application/vnd.openxmlformats-package.core-properties+xml","application/vnd.openxmlformats-officedocument.extended-properties+xml","application/vnd.openxmlformats-officedocument.custom-properties+xml"],s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="Common"}var t,r;return t=e,(r=[{key:"getFileType",value:function(e){var t=e.doc,r=t.invertedContentTypes;if(r){for(var n,o=Object.keys(a),s=0,l=o.length;s<l;s++)for(var u=a[o[s]],c=0,p=u.length;c<p;c++){var f=u[c];r[f]&&(n=o[s],Array.prototype.push.apply(t.targets,r[f]))}for(var h=0,d=i.length;h<d;h++){var g=i[h];r[g]&&Array.prototype.push.apply(t.targets,r[g])}return n}}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=function(){return o(new s)}},999:function(e,t,r){var n=r(509),o=r(557),a=o.getLeft,i=o.getRight,s=r(223),l=r(505).getExpandToDefault,u=r(257),c=u.getUnmatchedLoopException,p=u.getClosingTagNotMatchOpeningTag,f=u.getUnbalancedLoopException;function h(e){switch(e.location){case"start":return 1;case"end":return-1}}function d(e,t){return null!=e&&null!=t&&("start"===e.part.location&&"end"===t.part.location&&e.part.value===t.part.value||""===t.part.value)}function g(e){for(var t=0,r=[];t<e.length;){var n=e[t].part;if("end"===n.location){if(0===t)return e.splice(0,1),r.push(c(n)),{traits:e,errors:r};var o=t,a=t-1,i=1;if(d(e[a],e[o]))return e.splice(o,1),e.splice(a,1),{errors:r,traits:e};for(;i<50;){var s=e[a-i],l=e[o+i];if(d(s,e[o]))return e.splice(o,1),e.splice(a-i,1),{errors:r,traits:e};if(d(e[a],l))return e.splice(o+i,1),e.splice(a,1),{errors:r,traits:e};i++}return r.push(p({tags:[e[a].part,e[o].part]})),e.splice(o,1),e.splice(a,1),{traits:e,errors:r}}t++}return e.forEach((function(e){var t=e.part;r.push(c(t))})),{traits:[],errors:r}}var v={name:"ExpandPairTrait",optionsTransformer:function(e,t){return this.expandTags=t.fileTypeConfig.expandTags.concat(t.options.paragraphLoop?t.fileTypeConfig.onParagraphLoop:[]),e},postparse:function(e,t){var r=this,o=t.getTraits,s=t.postparse,u=o("expandPair",e);u=u.map((function(e){return e||[]}));var c=function(e){for(var t={},r=[],n=[],o=0,a=[],i=0;i<e.length;i++){var s=e[i],l=s.part,u=h(s.part);o+=u;var c;c=1===u?o-1:o,a.push({level:c,part:l})}for(;a.length>0;){var p=g(a);r=r.concat(p.errors),a=p.traits}if(r.length>0)return{pairs:n,errors:r};o=0;for(var f=0;f<e.length;f++){var d=e[f],v=h(d.part);if(o+=v,1===v)t[o]=d;else{var m=t[o+1];0===o&&(n=n.concat([[m,d]]))}o=o>=0?o:0}return{pairs:n,errors:r}}(u=n(u)),p=c.pairs,d=c.errors,v=0,m=null,y=p.map((function(t){var n,o,s=t[0].part.expandTo;if("auto"===s){var u=l(e,t,r.expandTags);u.error&&d.push(u.error),s=u.value}if(!s){var c=t[0].offset,p=t[1].offset;return c<v&&d.push(f(t,m)),m=t,v=p,[c,p]}try{n=a(e,s,t[0].offset)}catch(e){d.push(e)}try{o=i(e,s,t[1].offset)}catch(e){d.push(e)}return n<v&&d.push(f(t,m)),v=o,m=t,[n,o]}));if(d.length>0)return{postparsed:e,errors:d};var x,w=0;return{postparsed:e.reduce((function(t,r,n){var o=w<p.length&&y[w][0]<=n&&n<=y[w][1],a=p[w],i=y[w];if(!o)return t.push(r),t;if(i[0]===n&&(x=[]),a[0].offset!==n&&a[1].offset!==n&&x.push(r),i[1]===n){var l=e[a[0].offset];l.subparsed=s(x,{basePart:l}),delete l.location,delete l.expandTo,t.push(l),w++}return t}),[]),errors:d}}};e.exports=function(){return s(v)}},19:function(e,t,r){function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=r(557),c=u.mergeObjects,p=u.chunkBy,f=u.last,h=u.isParagraphStart,d=u.isModule,g=u.isParagraphEnd,v=u.isContent,m=u.startsWith,y=u.isTagEnd,x=u.isTagStart,w=u.getSingleAttribute,b=u.setSingleAttribute,T=r(223),P="loop";function O(e){var t=function(e){for(var t=0,r=e.length;t<r;t++)if("content"!==e[t].type)return e[t];return null}(e.subparsed);return null!=t&&"w:t"!==t.tag}function E(e){return e.hasPageBreak&&O(e)?'<w:p><w:r><w:br w:type="page"/></w:r></w:p>':""}function j(e){return e.some((function(e){return v(e)}))?0:e.length}function k(e){return e.some((function(e){return"w:br"===e.tag&&-1!==e.value.indexOf('w:type="page"')}))}function C(e){return e.some((function(e){return"w:drawing"===e.tag}))}var S=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="LoopModule",this.inXfrm=!1,this.totalSectPr=0,this.prefix={start:"#",end:"/",dash:/^-([^\s]+)\s(.+)/,inverted:"^"}}var t,r;return t=e,r=[{key:"optionsTransformer",value:function(e,t){return this.docxtemplater=t,e}},{key:"preparse",value:function(e,t){var r,n;"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"===t.contentType&&(this.sects=(r=!1,n=[],e.forEach((function(e){x("w:sectPr",e)&&(n.push([]),r=!0),r&&n[n.length-1].push(e),y("w:sectPr",e)&&(r=!1)})),n))}},{key:"matchers",value:function(){var e=P;return[[this.prefix.start,e,{expandTo:"auto",location:"start",inverted:!1}],[this.prefix.inverted,e,{expandTo:"auto",location:"start",inverted:!0}],[this.prefix.end,e,{location:"end"}],[this.prefix.dash,e,function(e){var t,r,n=(r=3,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return a}}(t,r)||i(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{location:"start",inverted:!1,expandTo:n[1],value:n[2]}}]]}},{key:"getTraits",value:function(e,t){if("expandPair"===e)return t.reduce((function(e,t,r){return d(t,P)&&null==t.subparsed&&e.push({part:t,offset:r}),e}),[])}},{key:"postparse",value:function(e,t){var r=t.basePart;if(r&&"docx"===this.docxtemplater.fileType){r.sectPrCount=function(e){var t=!1,r=0;return e.forEach((function(e){x("w:sectPr",e)&&(t=!0),t&&("w:headerReference"!==e.tag&&"w:footerReference"!==e.tag||(r++,t=!1)),y("w:sectPr",e)&&(t=!1)})),r}(e),this.totalSectPr+=r.sectPrCount;var n=this.sects;n.some((function(e,t){if(e[0].lIndex>r.lIndex)return t+1<n.length&&n[t+1].some((function(e){return x("w:type",e)&&-1!==e.value.indexOf("continuous")}))&&(r.addContinuousType=!0),!0})),r.lastParagrapSectPr=function(e){for(var t=[],r=!1,n=e.length-1;n>=0;n--){var o=e[n];if(y("w:sectPr",o)&&(r=!0),x("w:sectPr",o)&&(t.unshift(o.value),r=!1),r&&t.unshift(o.value),h(o)){if(t.length>0)return t.join("");break}}return""}(e)}if(!r||"auto"!==r.expandTo||r.module!==P||!function(e){return e.length&&h(e[0])&&g(f(e))}(e))return e;r.paragraphLoop=!0;var o=0,a=p(e,(function(e){return h(e)&&1==++o?"start":g(e)&&0==--o?"end":null})),i=a[0],s=f(a),l=j(i),u=j(s);return r.hasPageBreakBeginning=k(i),r.hasPageBreak=k(s),C(i)&&(l=0),C(s)&&(u=0),e.slice(l,e.length-u)}},{key:"resolve",value:function(e,t){if(!d(e,P))return null;var r=t.scopeManager,n=r.getValueAsync(e.value,{part:e}),o=[];function a(n,a,i){var s=r.createSubScopeManager(n,e.value,a,e,i);o.push(t.resolve({filePath:t.filePath,modules:t.modules,baseNullGetter:t.baseNullGetter,resolve:t.resolve,compiled:e.subparsed,tags:{},scopeManager:s}))}var l=[];return n.then((function(t){return new Promise((function(e){t instanceof Array?Promise.all(t).then(e):e(t)})).then((function(t){return r.loopOverValue(t,a,e.inverted),Promise.all(o).then((function(e){return e.map((function(e){var t,r=e.resolved,n=e.errors;return l.push.apply(l,function(e){if(Array.isArray(e))return s(e)}(t=n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||i(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r}))})).then((function(e){if(l.length>0)throw l;return e}))}))}))}},{key:"render",value:function(e,t){if("p:xfrm"===e.tag&&(this.inXfrm="start"===e.position),"a:ext"===e.tag&&this.inXfrm)return this.lastExt=e,e;if(!d(e,P))return null;var r=[],n=[],a=0,i=e.subparsed[0],s=0;"a:tr"===(null==i?void 0:i.tag)&&(s=+w(i.value,"h")),a-=s;var l=0;if(!1===t.scopeManager.loopOver(e.value,(function(o,i,u){a+=s;var p=t.scopeManager.createSubScopeManager(o,e.value,i,e,u);e.subparsed.forEach((function(e){if(x("a16:rowId",e)){var t=+w(e.value,"val")+l;l=1,e.value=b(e.value,"val",t)}}));var f=t.render(c({},t,{compiled:e.subparsed,tags:{},scopeManager:p}));e.hasPageBreak&&i===u-1&&O(e)&&function(e){for(var t=!1,r=e.parts.length-1,n=e.parts.length-1;r>=0;r--)if("</w:p>"===e.parts[n]&&!t){t=!0,e.parts.splice(n,0,'<w:r><w:br w:type="page"/></w:r>');break}t||e.parts.push('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}(f);var h,d,g,v=p.scopePathItem.some((function(e){return 0!==e}));v&&(1===e.sectPrCount&&(f.parts=f.parts.filter((function(e){return!m(e,"<w:headerReference")&&!m(e,"<w:footerReference")}))),e.addContinuousType&&(f.parts=(h=f.parts,d=!1,g=!1,h.reduce((function(e,t){return!1===d&&m(t,"<w:sectPr")&&(g=!0),g&&(m(t,"<w:type")&&(d=!0),!1===d&&m(t,"</w:sectPr")&&e.push('<w:type w:val="continuous"/>')),e.push(t),e}),[])))),e.hasPageBreakBeginning&&O(e)&&function(e){e.parts.unshift('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}(f);for(var y=0,T=f.parts.length;y<T;y++)r.push(f.parts[y]);Array.prototype.push.apply(n,f.errors)}),e.inverted,{part:e}))return e.lastParagrapSectPr?e.paragraphLoop?{value:"<w:p><w:pPr>".concat(e.lastParagrapSectPr,"</w:pPr></w:p>")}:{value:"</w:t></w:r></w:p><w:p><w:pPr>".concat(e.lastParagrapSectPr,"</w:pPr><w:r><w:t>")}:{value:E(e)||"",errors:n};if(0!==a){var u=+w(this.lastExt.value,"cy");this.lastExt.value=b(this.lastExt.value,"cy",u+a)}return{value:t.joinUncorrupt(r,o(o({},t),{},{basePart:e})),errors:n}}}],r&&l(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=function(){return T(new S)}},182:function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(505),a=r(557).isContent,i=r(257),s=i.throwRawTagShouldBeOnlyTextInParagraph,l=i.getInvalidRawXMLValueException,u="rawxml",c=r(223);function p(e){var t=e.part,r=e.left,n=e.right,o=e.postparsed,i=e.index,l=o.slice(r+1,n);return l.forEach((function(e,n){n!==i-r-1&&a(e)&&s({paragraphParts:l,part:t})})),t}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="RawXmlModule",this.prefix="@"}var t,r;return t=e,(r=[{key:"optionsTransformer",value:function(e,t){return this.fileTypeConfig=t.fileTypeConfig,e}},{key:"matchers",value:function(){return[[this.prefix,u]]}},{key:"postparse",value:function(e){return o.expandToOne(e,{moduleName:u,getInner:p,expandTo:this.fileTypeConfig.tagRawXml,error:{message:"Raw tag not in paragraph",id:"raw_tag_outerxml_invalid",explanation:function(e){return'The tag "'.concat(e.value,'" is not inside a paragraph, putting raw tags inside an inline loop is disallowed.')}}})}},{key:"render",value:function(e,t){if(e.module!==u)return null;var r,n=[];try{null==(r=t.scopeManager.getValue(e.value,{part:e}))&&(r=t.nullGetter(e))}catch(e){return n.push(e),{errors:n}}return r?"string"==typeof r?{value:r}:{errors:[l({tag:e.value,value:r,offset:e.offset})]}:{value:""}}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=function(){return c(new f)}},163:function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(223),a=r(257).getScopeCompilationError,i=r(557),s=i.utf8ToWord,l=i.hasCorruptCharacters,u=r(257).getCorruptCharactersException,c={docx:"w",pptx:"a"},p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="Render",this.recordRun=!1,this.recordedRun=[]}var t,r;return t=e,(r=[{key:"optionsTransformer",value:function(e,t){return this.parser=t.parser,this.fileType=t.fileType,e}},{key:"set",value:function(e){e.compiled&&(this.compiled=e.compiled),null!=e.data&&(this.data=e.data)}},{key:"getRenderedMap",value:function(e){var t=this;return Object.keys(this.compiled).reduce((function(e,r){return e[r]={from:r,data:t.data},e}),e)}},{key:"postparse",value:function(e,t){var r=this,n=[];return e.forEach((function(e){if("placeholder"===e.type){var o=e.value;try{t.cachedParsers[e.lIndex]=r.parser(o,{tag:e})}catch(t){n.push(a({tag:o,rootError:t,offset:e.offset}))}}})),{postparsed:e,errors:n}}},{key:"render",value:function(e,t){var r=t.scopeManager,n=t.linebreaks,o=t.nullGetter;if(n&&this.recordRuns(e),"placeholder"===e.type&&!e.module){var a;try{a=r.getValue(e.value,{part:e})}catch(e){return{errors:[e]}}return null==a&&(a=o(e)),l(a)?{errors:[u({tag:e.value,value:a,offset:e.offset})]}:{value:n&&"string"==typeof a?this.renderLineBreaks(a):s(a)}}}},{key:"recordRuns",value:function(e){e.tag==="".concat(c[this.fileType],":r")?this.recordedRun=[]:e.tag==="".concat(c[this.fileType],":rPr")?("start"===e.position&&(this.recordRun=!0,this.recordedRun=[e.value]),"end"===e.position&&(this.recordedRun.push(e.value),this.recordRun=!1)):this.recordRun&&this.recordedRun.push(e.value)}},{key:"renderLineBreaks",value:function(e){var t=this,r=c[this.fileType],n="docx"===this.fileType?"<w:r><w:br/></w:r>":"<a:br/>",o=e.split("\n"),a=this.recordedRun.join("");return o.map((function(e){return s(e)})).reduce((function(e,i,s){return e.push(i),s<o.length-1&&e.push("</".concat(r,":t></").concat(r,":r>").concat(n,"<").concat(r,":r>").concat(a,"<").concat(r,":t").concat("docx"===t.fileType?' xml:space="preserve"':"",">")),e}),[])}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=function(){return o(new p)}},95:function(e,t,r){var n=r(223),o=r(557),a=o.isTextStart,i=o.isTextEnd,s=o.endsWith,l=o.startsWith,u='<w:t xml:space="preserve">',c=u.length,p="</w:t>",f=p.length;function h(e,t){var r=e[t].value;return"</w:t>"===e[t+1].value||-1!==r.indexOf('xml:space="preserve"')?r:r.substr(0,r.length-1)+' xml:space="preserve">'}var d={name:"SpacePreserveModule",postparse:function(e,t){var r=[],n=!1,o=0,s=0,l=e.reduce((function(e,l){return function(e){return a(e)&&"w:t"===e.tag}(l)&&(n=!0,s=r.length),n?(r.push(l),function(e,t){return e&&e.basePart&&t.length>1}(t,r)&&(o=t.basePart.endLindex,r[0].value=h(r,0)),function(e,t){return"placeholder"===e.type&&(!e.module||"loop"===e.module)&&t.length>1}(l,r)&&(r[s].value=h(r,s),o=l.endLindex),i(l)&&l.lIndex>o&&(0!==o&&(r[s].value=h(r,s)),Array.prototype.push.apply(e,r),r=[],n=!1,o=0,s=0),e):(e.push(l),e)}),[]);return Array.prototype.push.apply(l,r),l},postrender:function(e){for(var t="",r=0,n=0,o=e.length;n<o;n++){var a=n,i=e[n];""!==i&&(s(t,u)&&l(i,p)&&(e[r]=t.substr(0,t.length-c)+"<w:t/>",i=i.substr(f)),t=i,r=a,e[n]=i)}return e}};e.exports=function(){return n(d)}},190:function(e,t,r){function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return a}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var u=r(557).wordToUtf8,c=r(3),p=c.match,f=c.getValue,h=c.getValues;var d={preparse:function(e,t,r){return{preparsed:function(e,r){return t.forEach((function(t){t.preparse(e,r)}))}(e,r)}},parse:function(e,t,r){var n,a=!1,c="",d=[];return e.reduce((function(e,g){return"delimiter"===g.type?(a="start"===g.position,"end"===g.position&&(r.parse=function(e){return function(e,t){var r,n=t.modules,a=t.startOffset,u=t.lIndex;t.offset=a,t.match=p,t.getValue=f,t.getValues=h;var c=function(e,t){for(var r=[],n=0,o=e.length;n<o;n++){var a=e[n];if(a.matchers){var i=a.matchers(t);if(!(i instanceof Array))throw new Error("module matcher returns a non array");r.push.apply(r,function(e){if(Array.isArray(e))return l(e)}(u=i)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(u)||s(u)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}}var u;return r}(n,t),d=function(e,t,r){for(var n=[],a=0,s=e.length;a<s;a++){var l=e[a],u=i(l,2),c=u[0],p=u[1],f=l[2]||{};if(r.match(c,t)){var h=r.getValues(c,t);if("function"==typeof f&&(f=f(h)),!f.value){var d=i(h,2);f.value=d[1]}n.push(o({type:"placeholder",prefix:c,module:p,onMatch:f.onMatch,priority:f.priority},f))}}return n}(c,e,t);if(d.length>0){var g=null;return d.forEach((function(e){e.priority=e.priority||-e.value.length,(!g||e.priority>g.priority)&&(g=e)})),g.offset=a,delete g.priority,g.endLindex=u,g.lIndex=u,g.raw=e,g.onMatch&&g.onMatch(g),delete g.onMatch,delete g.prefix,g}for(var v=0,m=n.length;v<m;v++)if(r=n[v].parse(e,t))return r.offset=a,r.endLindex=u,r.lIndex=u,r.raw=e,r;return{type:"placeholder",value:e,offset:a,endLindex:u,lIndex:u}}(e,o(o(o({},r),g),{},{startOffset:n,modules:t}))},e.push(r.parse(u(c))),Array.prototype.push.apply(e,d),d=[]),"start"===g.position&&(d=[],n=g.offset),c="",e):a?"content"!==g.type||"insidetag"!==g.position?(d.push(g),e):(c+=g.value,e):(e.push(g),e)}),[])},postparse:function(e,t,r){function n(e,r){return t.map((function(t){return t.getTraits(e,r)}))}var a=[];return{postparsed:function e(r,i){return t.reduce((function(t,r){var s=r.postparse(t,o(o({},i),{},{postparse:function(t,r){return e(t,o(o({},i),r))},getTraits:n}));return null==s?t:s.errors?(Array.prototype.push.apply(a,s.errors),s.postparsed):s}),r)}(e,r),errors:a}}};e.exports=d},393:function(e){function t(e){var t,r,n,o,a=0,i=e.length;for(n=0;n<i;n++)55296==(64512&(t=e.charCodeAt(n)))&&n+1<i&&56320==(64512&(r=e.charCodeAt(n+1)))&&(t=65536+(t-55296<<10)+(r-56320),n++),a+=t<128?1:t<2048?2:t<65536?3:4;var s=new Uint8Array(a);for(o=0,n=0;o<a;n++)55296==(64512&(t=e.charCodeAt(n)))&&n+1<i&&56320==(64512&(r=e.charCodeAt(n+1)))&&(t=65536+(t-55296<<10)+(r-56320),n++),t<128?s[o++]=t:t<2048?(s[o++]=192|t>>>6,s[o++]=128|63&t):t<65536?(s[o++]=224|t>>>12,s[o++]=128|t>>>6&63,s[o++]=128|63&t):(s[o++]=240|t>>>18,s[o++]=128|t>>>12&63,s[o++]=128|t>>>6&63,s[o++]=128|63&t);return s}e.exports=function(e,r){for(var n=0,o=r.modules.length;n<o;n++)e=r.modules[n].postrender(e,r);for(var a=0,i=r.joinUncorrupt(e,r),s="",l=0,u=[],c=0,p=i.length;c<p;c++){var f=i[c];if(f.length+l>65536){var h=t(s);a+=h.length,u.push(h),s=""}s+=f,l+=f.length,delete i[c]}var d=t(s);a+=d.length,u.push(d);var g=new Uint8Array(a),v=0;return u.forEach((function(e){for(var t=0;t<e.length;++t)g[t+v]=e[t];v+=e.length})),g}},3:function(e){var t=new RegExp(String.fromCharCode(160),"g");function r(e){return e.replace(t," ")}e.exports={match:function(e,t){return"string"==typeof e?r(t.substr(0,e.length))===e:e instanceof RegExp?e.test(r(t)):void 0},getValue:function(e,t){return"string"==typeof e?r(t).substr(e.length):e instanceof RegExp?r(t).match(e)[1]:void 0},getValues:function(e,t){return"string"==typeof e?[t,r(t).substr(e.length)]:e instanceof RegExp?r(t).match(e):void 0}}},89:function(e,t,r){var n=r(257).throwUnimplementedTagType;e.exports=function(e){var t=e.baseNullGetter,r=e.compiled,o=e.scopeManager;e.nullGetter=function(e,r){return t(e,r||o)};var a=[],i=r.map((function(t,r){e.index=r;var o=function(e,t){for(var r,n=0,o=t.modules.length;n<o;n++)if(r=t.modules[n].render(e,t))return r;return!1}(t,e);return o?(o.errors&&Array.prototype.push.apply(a,o.errors),o):"content"===t.type||"tag"===t.type?t:void n(t,r)})).reduce((function(e,t){var r=t.value;if(r instanceof Array)for(var n=0,o=r.length;n<o;n++)e.push(r[n]);else r&&e.push(r);return e}),[]);return{errors:a,parts:i}}},207:function(e){function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}e.exports=function(e){var r=[],n=e.baseNullGetter,o=e.compiled,a=e.scopeManager;e.nullGetter=function(e,t){return n(e,t||a)},e.resolved=r;var i=[];return Promise.all(o.filter((function(e){return-1===["content","tag"].indexOf(e.type)})).reduce((function(n,o){var s,l=function(e,t){for(var r,n=0,o=t.modules.length;n<o;n++)if(r=t.modules[n].resolve(e,t))return r;return!1}(o,e);if(l)s=l.then((function(e){r.push({tag:o.value,value:e,lIndex:o.lIndex})}));else{if("placeholder"!==o.type)return;s=a.getValueAsync(o.value,{part:o}).then((function(t){return null==t&&(t=e.nullGetter(o)),r.push({tag:o.value,value:t,lIndex:o.lIndex}),t}))}return n.push(s.catch((function(e){var r;e instanceof Array?i.push.apply(i,function(e){if(Array.isArray(e))return t(e)}(r=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()):i.push(e)}))),n}),[])).then((function(){return{errors:i,resolved:r}}))}},919:function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(257).getScopeParserExecutionError,a=r(287).last,i=r(557).concatArrays;function s(e,t){for(var r,n=e.length>>>0,o=0;o<n;o++)if(r=e[o],t.call(this,r,o,e))return r}function l(e,t,r){var n,a,i=this,u=this.scopeList[r];if(this.root.finishedResolving){var c=this.resolved;return this.scopePath.slice(this.resolveOffset).forEach((function(e,t){var r=i.scopeLindex[t];c=(c=s(c,(function(e){return e.lIndex===r}))).value[i.scopePathItem[t]]})),s(c,(function(e){return t.part.lIndex===e.lIndex})).value}a=this.cachedParsers&&t.part?this.cachedParsers[t.part.lIndex]?this.cachedParsers[t.part.lIndex]:this.cachedParsers[t.part.lIndex]=this.parser(e,{scopePath:this.scopePath}):this.parser(e,{scopePath:this.scopePath});try{n=a.get(u,this.getContext(t,r))}catch(r){throw o({tag:e,scope:u,error:r,offset:t.part.offset})}return null==n&&r>0?l.call(this,e,t,r-1):n}function u(e,t,r){var n,a=this,i=this.scopeList[r];return n=this.cachedParsers&&t.part?this.cachedParsers[t.part.lIndex]?this.cachedParsers[t.part.lIndex]:this.cachedParsers[t.part.lIndex]=this.parser(e,{scopePath:this.scopePath}):this.parser(e,{scopePath:this.scopePath}),Promise.resolve().then((function(){return n.get(i,a.getContext(t,r))})).catch((function(r){throw o({tag:e,scope:i,error:r,offset:t.part.offset})})).then((function(n){return null==n&&r>0?u.call(a,e,t,r-1):n}))}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.root=t.root||this,this.resolveOffset=t.resolveOffset||0,this.scopePath=t.scopePath,this.scopePathItem=t.scopePathItem,this.scopePathLength=t.scopePathLength,this.scopeList=t.scopeList,this.scopeLindex=t.scopeLindex,this.parser=t.parser,this.resolved=t.resolved,this.cachedParsers=t.cachedParsers}var t,r;return t=e,(r=[{key:"loopOver",value:function(e,t,r,n){return this.loopOverValue(this.getValue(e,n),t,r)}},{key:"functorIfInverted",value:function(e,t,r,n,o){return e&&t(r,n,o),e}},{key:"isValueFalsy",value:function(e,t){return null==e||!e||"[object Array]"===t&&0===e.length}},{key:"loopOverValue",value:function(e,t,r){this.root.finishedResolving&&(r=!1);var n=Object.prototype.toString.call(e);if(this.isValueFalsy(e,n))return this.functorIfInverted(r,t,a(this.scopeList),0,1);if("[object Array]"===n){for(var o=0;o<e.length;o++)this.functorIfInverted(!r,t,e[o],o,e.length);return!0}return"[object Object]"===n?this.functorIfInverted(!r,t,e,0,1):this.functorIfInverted(!r,t,a(this.scopeList),0,1)}},{key:"getValue",value:function(e,t){var r=l.call(this,e,t,this.scopeList.length-1);return"function"==typeof r?r(this.scopeList[this.scopeList.length-1],this):r}},{key:"getValueAsync",value:function(e,t){var r=this;return u.call(this,e,t,this.scopeList.length-1).then((function(e){return"function"==typeof e?e(r.scopeList[r.scopeList.length-1],r):e}))}},{key:"getContext",value:function(e,t){return{num:t,meta:e,scopeList:this.scopeList,resolved:this.resolved,scopePath:this.scopePath,scopePathItem:this.scopePathItem,scopePathLength:this.scopePathLength}}},{key:"createSubScopeManager",value:function(t,r,n,o,a){return new e({root:this.root,resolveOffset:this.resolveOffset,resolved:this.resolved,parser:this.parser,cachedParsers:this.cachedParsers,scopeList:i([this.scopeList,[t]]),scopePath:i([this.scopePath,[r]]),scopePathItem:i([this.scopePathItem,[n]]),scopePathLength:i([this.scopePathLength,[a]]),scopeLindex:i([this.scopeLindex,[o.lIndex]])})}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=function(e){return e.scopePath=[],e.scopePathItem=[],e.scopePathLength=[],e.scopeLindex=[],e.scopeList=[e.tags],new c(e)}},505:function(e,t,r){function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw o}}return a}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}var u=r(557),c=u.getRightOrNull,p=u.getRight,f=u.getLeft,h=u.getLeftOrNull,d=u.chunkBy,g=u.isTagStart,v=u.isTagEnd,m=u.isContent,y=u.last,x=u.first,w=r(257),b=w.XTTemplateError,T=w.throwExpandNotFound,P=w.getLoopPositionProducesInvalidXMLError;function O(e,t){return 0!==e.length&&0===y(e).substr(1).indexOf(t)}function E(e,t,r,n){var o=e.expandTo||n.expandTo;if(o){var a,l;try{l=f(r,o,t),a=p(r,o,t)}catch(a){throw a instanceof b&&T(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({part:e,rootError:a,postparsed:r,expandTo:o,index:t},n.error)),a}return[l,a]}}e.exports={expandToOne:function(e,t){var r=[];e.errors&&(r=e.errors,e=e.postparsed);for(var i=[],s=0,l=e.length;s<l;s++){var u=e[s];if("placeholder"===u.type&&u.module===t.moduleName)try{var c=E(u,s,e,t);if(!c)continue;var p=n(c,2),f=p[0],h=p[1];i.push({left:f,right:h,part:u,i:s,leftPart:e[f],rightPart:e[h]})}catch(e){if(!(e instanceof b))throw e;r.push(e)}}i.sort((function(e,t){return e.left===t.left?t.part.lIndex<e.part.lIndex?1:-1:t.left<e.left?1:-1}));var d=-1,g=0;return i.forEach((function(s,l){var u,c;if(d=Math.max(d,l>0?i[l-1].right:0),!(s.left<d)){var p;try{p=function(e,t,r,o){var a=n(e,2),i=a[0],s=a[1],l=r.indexOf(t),u=r.slice(i,l),c=r.slice(l+1,s+1),p=o.getInner({postparse:o.postparse,index:l,part:t,leftParts:u,rightParts:c,left:i,right:s,postparsed:r});return p.length||(p.expanded=[u,c],p=[p]),{left:i,right:s,inner:p}}([s.left+g,s.right+g],s.part,e,t)}catch(e){if(!(e instanceof b))throw e;r.push(e)}p&&(g+=p.inner.length-(p.right+1-p.left),(u=e).splice.apply(u,[p.left,p.right+1-p.left].concat(function(e){if(Array.isArray(e))return a(e)}(c=p.inner)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(c)||o(c)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())))}})),{postparsed:e,errors:r}},getExpandToDefault:function(e,t,r){var n=function(e){for(var t=e.filter((function(e){return"tag"===e.type})),r=[],n=0;n<t.length;n++){var o=t[n],a=o.position,i=o.value,s=o.tag;"end"===a?O(r,s)?r.pop():r.push(i):"start"===a&&r.push(i)}return r}(e.slice(t[0].offset,t[1].offset));if(n.filter((function(e){return"/"===e[1]})).length!==n.filter((function(e){return"/"!==e[1]&&"/"!==e[e.length-2]})).length)return{error:P({tag:x(t).part.value,offset:[x(t).part.offset,y(t).part.offset]})};for(var o=function(o,a){var i=r[o],s=i.contains,l=i.expand,u=i.onlyTextInTag;if(function(e,t){for(var r=0;r<t.length;r++)if(0===t[r].indexOf("<".concat(e)))return!0;return!1}(s,n)){if(u){var p=h(e,s,t[0].offset),f=c(e,s,t[1].offset);if(null===p||null===f)return"continue";var w=d(e.slice(p,f),(function(e){return g(s,e)?"start":v(s,e)?"end":null})),b=x(w),T=y(w),P=b.filter(m),O=T.filter(m);if(1!==P.length||1!==O.length)return"continue"}return{v:{value:l}}}},a=0,i=r.length;a<i;a++){var s=o(a);if("continue"!==s&&"object"===l(s))return s.v}return{}}}},287:function(e){e.exports={last:function(e){return e[e.length-1]},first:function(e){return e[0]}}},465:function(e,t,r){var n=r(557).pregMatchAll;e.exports=function(e,t){var r={content:e},o=t.join("|"),a=new RegExp("(?:(<(?:".concat(o,")[^>]*>)([^<>]*)</(?:").concat(o,")>)|(<(?:").concat(o,")[^>]*/>)"),"g");return r.matches=n(a,r.content),r}},827:function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(557),a=o.wordToUtf8,i=o.convertSpaces,s=r(465),l=r(303),u=r(190),c=r(89),p=r(393),f=r(207),h=r(127);e.exports=function(){function e(t,r){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cachedParsers={},this.content=t,Object.keys(r).forEach((function(e){n[e]=r[e]})),this.setModules({inspect:{filePath:r.filePath}})}var t,r;return t=e,r=[{key:"resolveTags",value:function(e){var t=this;this.tags=e;var r=this.getOptions(),n=this.filePath;return r.scopeManager=this.scopeManager,r.resolve=f,f(r).then((function(e){var o=e.resolved,a=e.errors;if(a.forEach((function(e){e.properties=e.properties||{},e.properties.file=n})),0!==a.length)throw a;return Promise.all(o).then((function(e){return r.scopeManager.root.finishedResolving=!0,r.scopeManager.resolved=e,t.setModules({inspect:{resolved:e,filePath:n}}),e}))}))}},{key:"getFullText",value:function(){return e=this.content,t=this.fileTypeConfig.tagsXmlTextArray,r=s(e,t).matches.map((function(e){return e.array[2]})),a(i(r.join("")));var e,t,r}},{key:"setModules",value:function(e){this.modules.forEach((function(t){t.set(e)}))}},{key:"preparse",value:function(){this.allErrors=[],this.xmllexed=l.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray}),this.setModules({inspect:{xmllexed:this.xmllexed}});var e=l.parse(this.xmllexed,this.delimiters),t=e.lexed,r=e.errors;this.allErrors=this.allErrors.concat(r),this.lexed=t,this.setModules({inspect:{lexed:this.lexed}});var n=this.getOptions();u.preparse(this.lexed,this.modules,n)}},{key:"parse",value:function(){this.setModules({inspect:{filePath:this.filePath}});var e=this.getOptions();this.parsed=u.parse(this.lexed,this.modules,e),this.setModules({inspect:{parsed:this.parsed}});var t=u.postparse(this.parsed,this.modules,e),r=t.postparsed,n=t.errors;return this.postparsed=r,this.setModules({inspect:{postparsed:this.postparsed}}),this.allErrors=this.allErrors.concat(n),this.errorChecker(this.allErrors),this}},{key:"errorChecker",value:function(e){var t=this;e.length&&(e.forEach((function(e){e.properties=e.properties||{},e.properties.file=t.filePath})),this.modules.forEach((function(t){e=t.errorsTransformer(e)})))}},{key:"baseNullGetter",value:function(e,t){var r=this,n=this.modules.reduce((function(n,o){return null!=n?n:o.nullGetter(e,t,r)}),null);return null!=n?n:this.nullGetter(e,t)}},{key:"getOptions",value:function(){return{compiled:this.postparsed,cachedParsers:this.cachedParsers,tags:this.tags,modules:this.modules,parser:this.parser,contentType:this.contentType,baseNullGetter:this.baseNullGetter.bind(this),filePath:this.filePath,fileTypeConfig:this.fileTypeConfig,fileType:this.fileType,linebreaks:this.linebreaks}}},{key:"render",value:function(e){this.filePath=e;var t=this.getOptions();t.resolved=this.scopeManager.resolved,t.scopeManager=this.scopeManager,t.render=c,t.joinUncorrupt=h;var r=c(t),n=r.errors,o=r.parts;return this.allErrors=n,this.errorChecker(n),n.length>0||(this.content=p(o,t),this.setModules({inspect:{content:this.content}})),this}}],r&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()}},t={},r=function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}(380);window.docxtemplater=r}();